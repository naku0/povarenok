<mat-card class="mini-card">
  <mat-card-header>
    <mat-card-title>{{ recipeData.name }}</mat-card-title>
    <mat-card-subtitle>
      <div class="difficulty">
        {{ recipeData.difficulty }}
      </div>

    </mat-card-subtitle>
  </mat-card-header>

  <div class="image-container">
    @if (recipeData.imageUrl) {
      <img mat-card-image [src]="recipeData.imageUrl" [alt]="recipeData.name">
    } @else {
      <div class="no-photo">
        <mat-icon>no_photography</mat-icon>
        <span>No photo</span>
      </div>
    }
  </div>

  <mat-card-content>
    <p class="description">{{ recipeData.description }}</p>

    <div class="stats">
      <div class="stat-item">
        <mat-icon>schedule</mat-icon>
        <span>{{ recipeData.totalTime }} мин</span>
      </div>
      <div class="stat-item">
        <mat-icon>restaurant</mat-icon>
        <span>{{ recipeData.servings }} порц.</span>
      </div>

    </div>

    <div class="author">
      <a [routerLink] = "['/user', recipeData.authorId]">
      <mat-icon>account_circle</mat-icon>
      <span>{{recipeData.authorName}}</span>
      </a>
    </div>

    <div class="meta">
      <span class="category">{{ recipeData.category }}</span>
      @if (recipeData.tags && recipeData.tags.length > 0) {
        <div class="tags">
          @for (tag of recipeData.tags.slice(0, 3); track tag) {
            <span class="tag">{{ tag }}</span>
          }
        </div>
      }
    </div>
    <div class="created-at">
      <span>Загружено {{ recipeData.createdAt | date:'dd.MM.yyyy HH:mm' }}</span>
    </div>
  </mat-card-content>

  <mat-card-actions>
    <button mat-button color="primary" [routerLink]="['/recipe', recipeData.id]">Подробнее...</button>

    @if (flag$ | async){
      <button matIconButton [matMenuTriggerFor]="menu" aria-label="Меню">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #menu = 'matMenu'>
        <button mat-menu-item (click)="handleChange()">
          <mat-icon>edit</mat-icon>
          Изменить
        </button>
        <button mat-menu-item (click)="handleDelete()">
          <mat-icon>delete</mat-icon>
          Удалить
        </button>
      </mat-menu>
    }
  </mat-card-actions>
</mat-card>
